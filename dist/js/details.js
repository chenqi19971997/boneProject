"use strict";function ownKeys(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,i)}return r}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach(function(e){_defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}require(["./config"],function(){require(["template","header","elevateZoom","footer","fly"],function(s,r,e){new(function(){function t(){var e=this;_classCallCheck(this,t),this.render().then(function(){e.addToCart(),e.addImgActive()})}return _createClass(t,[{key:"render",value:function(){var l=this,e=location.search.slice(4)-0;return console.log(e),new Promise(function(c){$.get("http://www.xiongmaoyouxuan.com/api/detail",{id:e},function(e){if(console.log(e),200===e.code){var t=e.data.detail,r=t.id,i=t.photo,o=t.title,n=t.price,a=t.originPrice;l.detail={id:r,photo:i,title:o,price:n,originPrice:a},$("#design").html(s("designTemplate",_objectSpread({},l.detail))),c()}})})}},{key:"addToCart",value:function(){var r=this;$(".btn2").on("click",function(e){console.log("点击了"),r.fly(e);var t=localStorage.getItem("cart");t?((t=JSON.parse(t)).some(function(e){return e.id===r.detail.id})?t=t.map(function(e){return e.id===r.detail.id&&e.count++,e}):t.push({id:r.detail.id,image:r.detail.photo[0].url,title:r.detail.title,price:r.detail.price,count:1}),localStorage.setItem("cart",JSON.stringify(t))):localStorage.setItem("cart",JSON.stringify([{id:r.detail.id,image:r.detail.photo[0].url,title:r.detail.title,price:r.detail.price,count:1}]))})}},{key:"fly",value:function(e){$('<img class="fly" src="'.concat(this.detail.photo[0].url,'">')).fly({start:{left:e.clientX,top:e.clientY},end:{left:$("#cart").offset().left-$(window).scrollLeft(),top:$("#cart").offset().top-$(window).scrollTop()},speed:.7,onEnd:function(){this.destroy(),r.calcCartCount()}})}},{key:"addImgActive",value:function(){$(".zoom-image").elevateZoom({gallery:"gal1"})}}]),t}())})});